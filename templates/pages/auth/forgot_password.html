{% extends "auth_base.html" %}
{% block title %}Quên mật khẩu | HUSC AI & Robotics{% endblock %}

{% block content %}

<div class="container d-flex justify-content-center align-items-center py-5" style="min-height: 80vh;">

    <div class="col-md-6 col-lg-4">

        <!-- Logo & Header -->
        <div class="text-center mb-4">
            <img src="/static/images/logo.jpg" alt="Logo"
                 class="rounded-circle border border-3 border-white shadow-sm mb-3"
                 width="80" height="80" style="object-fit: cover;">
            <h4 class="fw-bold text-dark mb-0">HUSC AI & ROBOTICS</h4>
            <p class="text-muted small">Khôi phục mật khẩu tài khoản</p>
        </div>

        <!-- Card -->
        <div class="card p-4 shadow-sm border-0 rounded-3 bg-white">
            <div class="card-body">

                <h5 class="card-title text-center mb-3 fw-bold text-primary">
                    Quên mật khẩu
                </h5>

                <p class="text-muted small text-center mb-4">
                    Nhập email đã đăng ký để nhận liên kết đặt lại mật khẩu.
                </p>

                <!-- FORM HTMX -->
                <form
                    hx-post="/api/auth/forgot_password/"
                    hx-target="#forgot-msg"
                    hx-swap="innerHTML"
                    onsubmit="disableButton(this)"
                >
                    <div class="form-floating mb-3">
                        <input type="email" 
                               class="form-control" 
                               id="email" 
                               name="email" 
                               placeholder="email@example.com" 
                               required>
                        <label for="email">Email đăng ký</label>
                    </div>

                    <button id="btn-submit" type="submit" class="btn btn-primary w-100 fw-bold py-2 rounded-3">
                        <i class="bi bi-envelope-paper me-2"></i>
                        Gửi email khôi phục
                    </button>
                </form>

                <!-- Message Result -->
                <div id="forgot-msg" class="mt-3"></div>

            </div>
        </div>

        <!-- Back to login -->
        <div class="text-center mt-4">
            <a href="/auth/signin" class="text-primary fw-medium small text-decoration-none">
                <i class="bi bi-arrow-left"></i> Quay lại đăng nhập
            </a>
        </div>

    </div>

</div>

<script>
    function disableButton(form) {
        const btn = form.querySelector("#btn-submit");
        btn.disabled = true;
        btn.innerHTML = `<span class="spinner-border spinner-border-sm me-2"></span>Đang gửi...`;
    }

    document.body.addEventListener("htmx:afterRequest", function() {
        const btn = document.querySelector("#btn-submit");
        if (btn) {
            btn.disabled = false;
            btn.innerHTML = `<i class="bi bi-envelope-paper me-2"></i> Gửi email khôi phục`;
        }
    });
</script>

{% endblock %}
