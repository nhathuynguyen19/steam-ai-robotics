<div id="users-table-container">
  <div class="table-responsive bg-white rounded-3 shadow-sm border">
    <table class="table table-hover align-middle mb-0">
      <thead class="bg-light">
        <tr>
          <th class="py-3 ps-4">ID</th>
          <th class="py-3">Họ và tên</th>
          <th class="py-3">Email</th>
          <th class="py-3 text-center">Vai trò</th>
          <th class="py-3 text-center">Trạng thái</th>
          <th class="py-3 text-end pe-4">Hành động</th>
        </tr>
      </thead>
      <tbody>
        {% if not users %}
        <tr>
          <td colspan="6" class="text-center py-4 text-muted">
            Không tìm thấy thành viên nào.
          </td>
        </tr>
        {% endif %} {% for u in users %}
        <tr>
          <td class="ps-4 text-muted small">#{{ u.user_id }}</td>
          <td class="fw-medium">{{ u.full_name }}</td>
          <td>{{ u.email }}</td>
          <td class="text-center">
            {% if u.role == 'admin' %}
            <span
              class="badge bg-primary bg-opacity-10 text-primary border border-primary border-opacity-25 rounded-pill"
              >Admin</span
            >
            {% else %}
            <span
              class="badge bg-secondary bg-opacity-10 text-secondary border rounded-pill"
              >User</span
            >
            {% endif %}
          </td>
          <td class="text-center">
            {% if u.status %}
            <i
              class="bi bi-check-circle-fill text-success"
              title="Đã kích hoạt"
            ></i>
            {% else %}
            <i
              class="bi bi-x-circle-fill text-danger"
              title="Chưa kích hoạt/Bị khóa"
            ></i>
            {% endif %}
          </td>
          <td class="text-end pe-4">
            <a
              href="/admin/users/{{ u.user_id }}/edit"
              class="btn btn-sm btn-outline-primary me-1"
              title="Chỉnh sửa"
            >
              <i class="bi bi-pencil"></i>
            </a>

            {% if u.user_id != user.user_id %}
            <button
              class="btn btn-sm btn-outline-danger"
              title="Xóa"
              hx-delete="/api/admin/users/{{ u.user_id }}"
              hx-confirm="Bạn có chắc muốn xóa user {{ u.email }} không? Hành động này không thể hoàn tác."
              hx-target="closest tr"
              hx-swap="outerHTML"
            >
              <i class="bi bi-trash"></i>
            </button>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% if total_pages > 1 %}
  <nav class="mt-4 d-flex justify-content-center">
    <ul class="pagination shadow-sm">
      <li class="page-item {% if page == 1 %}disabled{% endif %}">
        <button
          class="page-link"
          hx-get="/admin/users?page={{ page - 1 }}&search={{ search or '' }}"
          hx-target="#users-table-container"
          hx-swap="outerHTML"
        >
          Trước
        </button>
      </li>

      <li class="page-item disabled">
        <span class="page-link text-muted"
          >Trang {{ page }} / {{ total_pages }}</span
        >
      </li>

      <li class="page-item {% if page == total_pages %}disabled{% endif %}">
        <button
          class="page-link"
          hx-get="/admin/users?page={{ page + 1 }}&search={{ search or '' }}"
          hx-target="#users-table-container"
          hx-swap="outerHTML"
        >
          Sau
        </button>
      </li>
    </ul>
  </nav>
  {% endif %}
</div>
